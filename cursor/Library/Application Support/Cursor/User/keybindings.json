// Cursor keybindings matching Zed configuration
[
    // ============================================================================
    // AI / COMPOSER
    // ============================================================================
    {
        "key": "cmd+i",
        "command": "composerMode.agent"
    },

    // ============================================================================
    // VIM MODE ESCAPE BINDINGS (matching Zed: j k, j j, k k, u u sequences)
    // ============================================================================
    {
        "key": "j k",
        "command": "extension.vim_escape",
        "when": "editorTextFocus && vim.active && vim.mode == 'Insert' && !inDebugRepl && !suggestWidgetVisible"
    },
    {
        "key": "j j",
        "command": "extension.vim_escape",
        "when": "editorTextFocus && vim.active && vim.mode == 'Insert' && !inDebugRepl && !suggestWidgetVisible"
    },
    {
        "key": "k k",
        "command": "extension.vim_escape",
        "when": "editorTextFocus && vim.active && vim.mode == 'Insert' && !inDebugRepl && !suggestWidgetVisible"
    },
    {
        "key": "u u",
        "command": "extension.vim_escape",
        "when": "editorTextFocus && vim.active && vim.mode == 'Insert' && !inDebugRepl && !suggestWidgetVisible"
    },

    // ============================================================================
    // FILE OPERATIONS & FORMATTING
    // ============================================================================

    // Save file (Cmd+S should work in all modes)
    {
        "key": "cmd+s",
        "command": "workbench.action.files.save"
    },

    // Leader fm to format file
    {
        "key": "space f m",
        "command": "editor.action.formatDocument",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // ============================================================================
    // FUZZY FINDING & SEARCH (Telescope equivalents)
    // ============================================================================

    // Alt+p for file finder
    {
        "key": "alt+p",
        "command": "workbench.action.quickOpen"
    },

    // Alt+Shift+P for buffer/tab switcher
    {
        "key": "alt+shift+p",
        "command": "workbench.action.showAllEditors"
    },

    // Leader ff for file finder
    {
        "key": "space f f",
        "command": "workbench.action.quickOpen",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // Leader fw for project-wide search (live grep)
    {
        "key": "space f w",
        "command": "workbench.action.findInFiles",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // Leader fr for find and replace
    {
        "key": "space f r",
        "command": "editor.action.startFindReplaceAction",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // Leader fb for buffer list
    {
        "key": "space f b",
        "command": "workbench.action.showAllEditors",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // Leader fz for search in current buffer
    {
        "key": "space f z",
        "command": "actions.find",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // Leader fo for recent files (oldfiles)
    {
        "key": "space f o",
        "command": "workbench.action.openRecent",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // ============================================================================
    // BUFFER/TAB NAVIGATION
    // ============================================================================

    // Tab/Shift-Tab for next/previous buffer (matching Zed)
    {
        "key": "tab",
        "command": "workbench.action.nextEditor",
        "when": "!editorTextFocus && !terminalFocus && !inQuickOpen"
    },
    {
        "key": "shift+tab",
        "command": "workbench.action.previousEditor",
        "when": "!editorTextFocus && !terminalFocus && !inQuickOpen"
    },

    // Alt+[ and Alt+] for previous/next tab
    {
        "key": "alt+]",
        "command": "workbench.action.nextEditor"
    },
    {
        "key": "alt+[",
        "command": "workbench.action.previousEditor"
    },

    // Alt+{ and Alt+} to swap items left/right (matching Zed)
    {
        "key": "alt+}",
        "command": "workbench.action.moveEditorRightInGroup"
    },
    {
        "key": "alt+{",
        "command": "workbench.action.moveEditorLeftInGroup"
    },

    // Leader x to close buffer
    {
        "key": "space x",
        "command": "workbench.action.closeActiveEditor",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // Alt+w l to close items to the right
    {
        "key": "alt+w l",
        "command": "workbench.action.closeEditorsToTheRight"
    },

    // Alt+w h to close items to the left
    {
        "key": "alt+w h",
        "command": "workbench.action.closeEditorsToTheLeft"
    },

    // Alt+w a to close all editors
    {
        "key": "alt+w a",
        "command": "workbench.action.closeAllEditors"
    },

    // ============================================================================
    // PANE NAVIGATION & SPLITS
    // ============================================================================

    // Alt+H from chat -> go back to editor (must come before general alt+h)
    {
        "key": "alt+h",
        "command": "workbench.action.focusActiveEditorGroup",
        "when": "!editorTextFocus && !editorFocus"
    },

    // Alt+h/l/j/k for pane navigation
    {
        "key": "alt+h",
        "command": "workbench.action.navigateLeft",
        "when": "editorTextFocus || editorFocus"
    },
    // Alt+l from file tree -> go to editor
    {
        "key": "alt+l",
        "command": "workbench.action.focusActiveEditorGroup",
        "when": "filesExplorerFocus || explorerViewletVisible && !editorTextFocus"
    },
    {
        "key": "alt+l",
        "command": "workbench.action.navigateRight",
        "when": "!filesExplorerFocus && !explorerViewletVisible"
    },
    {
        "key": "alt+j",
        "command": "workbench.action.navigateDown"
    },
    {
        "key": "alt+k",
        "command": "workbench.action.navigateUp"
    },

    // Space Shift+L/J for split and move
    {
        "key": "space shift+l",
        "command": "workbench.action.moveEditorToRightGroup",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },
    {
        "key": "space shift+j",
        "command": "workbench.action.moveEditorToBelowGroup",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Leader l to focus next editor group
    {
        "key": "space l",
        "command": "workbench.action.focusNextGroup",
        "when": "editorTextFocus && vim.mode == 'Normal' && !inDebugRepl"
    },

    // ============================================================================
    // SIDEBAR / FILE TREE
    // ============================================================================

    // Alt+b to toggle sidebar
    {
        "key": "alt+b",
        "command": "workbench.action.toggleSidebarVisibility"
    },

    // Alt+Shift+B to reveal current file in sidebar
    {
        "key": "alt+shift+b",
        "command": "workbench.files.action.showActiveFileInExplorer"
    },

    // Space l in sidebar to toggle focus back to editor
    {
        "key": "space l",
        "command": "workbench.action.focusActiveEditorGroup",
        "when": "sideBarFocus && !editorTextFocus"
    },

    // File explorer: Enter to open file (override default rename behavior)
    {
        "key": "enter",
        "command": "list.select",
        "when": "explorerViewletVisible && filesExplorerFocus && !inputFocus"
    },

    // File explorer: 'a' to create new file
    {
        "key": "a",
        "command": "explorer.newFile",
        "when": "explorerViewletVisible && filesExplorerFocus && !inputFocus"
    },

    // File explorer: Shift+A to create new directory
    {
        "key": "shift+a",
        "command": "explorer.newFolder",
        "when": "explorerViewletVisible && filesExplorerFocus && !inputFocus"
    },

    // File explorer: x to delete
    {
        "key": "x",
        "command": "deleteFile",
        "when": "explorerViewletVisible && filesExplorerFocus && !inputFocus"
    },

    // File explorer: Shift+R to rename
    {
        "key": "shift+r",
        "command": "renameFile",
        "when": "explorerViewletVisible && filesExplorerFocus && !inputFocus"
    },

    // ============================================================================
    // VIM ENHANCEMENTS
    // ============================================================================

    // Alt+z to toggle fold (matching nvim's Alt+z for za)
    {
        "key": "alt+z",
        "command": "editor.toggleFold",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Clear search highlights with Escape
    {
        "key": "escape",
        "command": "vim.remap",
        "when": "vim.mode == 'Normal' && editorTextFocus",
        "args": {
            "after": [
                ":",
                "n",
                "o",
                "h",
                "l",
                "<CR>"
            ]
        }
    },

    // ============================================================================
    // LINE NUMBERS & DISPLAY
    // ============================================================================

    // Leader n to toggle line numbers
    {
        "key": "space n",
        "command": "editor.action.toggleRenderWhitespace",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Leader rn to toggle relative line numbers
    {
        "key": "space r n",
        "command": "vim.remap",
        "when": "editorTextFocus && vim.mode == 'Normal'",
        "args": {
            "commands": [
                {
                    "command": "settings.action.editFocusedSetting"
                }
            ]
        }
    },

    // ============================================================================
    // COMMENTS
    // ============================================================================

    // Leader / for toggle comment (normal mode)
    {
        "key": "space /",
        "command": "editor.action.commentLine",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Leader / for toggle comment (visual mode)
    {
        "key": "space /",
        "command": "editor.action.commentLine",
        "when": "editorTextFocus && vim.mode == 'Visual'"
    },

    // ============================================================================
    // LSP / DIAGNOSTICS
    // ============================================================================

    // Leader ds for diagnostics
    {
        "key": "space d s",
        "command": "workbench.actions.view.problems",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Leader ca for code actions
    {
        "key": "space c a",
        "command": "editor.action.quickFix",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Leader rn for rename symbol
    {
        "key": "space r r",
        "command": "editor.action.rename",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // NOTE: gd, gr, gg, G are handled natively by the Vim extension
    // Do NOT add VSCode keybindings for g* commands as they intercept the g prefix

    // K for hover documentation
    {
        "key": "shift+k",
        "command": "editor.action.showHover",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // ============================================================================
    // GIT
    // ============================================================================

    // Leader gt to toggle git blame
    {
        "key": "space g t",
        "command": "gitlens.toggleLineBlame",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // Leader gs for git status / source control
    {
        "key": "space g s",
        "command": "workbench.view.scm",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    },

    // ============================================================================
    // WINDOW MANAGEMENT
    // ============================================================================

    // Ctrl+Shift+Z to toggle zoom (matching Zed)
    {
        "key": "ctrl+shift+z",
        "command": "workbench.action.toggleZenMode"
    },

    // Alt+Shift+M to toggle zoom (matching Zed)
    {
        "key": "alt+shift+m",
        "command": "workbench.action.toggleZenMode"
    },

    // ============================================================================
    // TAB SWITCHER NAVIGATION
    // ============================================================================

    // Shift+Space: toggle tab switcher (matching Zed - ToggleAll)
    {
        "key": "shift+space",
        "command": "workbench.action.showAllEditors",
        "when": "(editorTextFocus || filesExplorerFocus) && vim.mode != 'Insert'"
    },

    // Shift+Tab: toggle tab switcher (matching Zed - Toggle)
    {
        "key": "shift+tab",
        "command": "workbench.action.showAllEditorsByMostRecentlyUsed",
        "when": "(editorTextFocus || filesExplorerFocus) && vim.mode != 'Insert'"
    },

    // Tab switcher navigation (j/k/w) - matching Zed TabSwitcher context
    {
        "key": "j",
        "command": "workbench.action.quickOpenSelectNext",
        "when": "inQuickOpen || activeViewlet == 'workbench.view.explorer'"
    },
    {
        "key": "k",
        "command": "workbench.action.quickOpenSelectPrevious",
        "when": "inQuickOpen || activeViewlet == 'workbench.view.explorer'"
    },
    {
        "key": "w",
        "command": "workbench.action.closeActiveEditor",
        "when": "inQuickOpen || activeViewlet == 'workbench.view.explorer'"
    },


    // ============================================================================
    // AI / EDIT PREDICTIONS (matching Zed)
    // ============================================================================

    // Ctrl+/ to show edit prediction in insert mode
    {
        "key": "ctrl+/",
        "command": "editor.action.inlineSuggest.trigger",
        "when": "editorTextFocus && vim.mode == 'Insert'"
    },

    // Ensure space inserts a literal space in insert mode (avoid leader wait)
    {
        "key": "space",
        "command": "type",
        "args": {
            "text": " "
        },
        "when": "editorTextFocus && vim.mode == 'Insert' && !suggestWidgetVisible"
    },

    // ============================================================================
    // TERMINAL
    // ============================================================================

    // Ctrl+` to toggle terminal (VSCode default, keeping for reference)
    {
        "key": "ctrl+`",
        "command": "workbench.action.terminal.toggleTerminal"
    },

    // Leader t t to toggle terminal
    {
        "key": "space t t",
        "command": "workbench.action.terminal.toggleTerminal",
        "when": "editorTextFocus && vim.mode == 'Normal'"
    }
]
